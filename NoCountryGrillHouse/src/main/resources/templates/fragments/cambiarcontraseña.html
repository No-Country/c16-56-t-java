<div id="editar_password" class="ocultar editar-password" style="display: none;">
    <a id="btn_perfil2" class="volver" href="#perfil_usuario">
        <svg width="28" height="16" viewBox="0 0 28 16" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path
                d="M7.94981 15.5201C8.0931 15.6553 8.28278 15.7304 8.47981 15.7301C8.6761 15.7318 8.86434 15.6521 8.99981 15.5101C9.14276 15.3708 9.22338 15.1797 9.22338 14.9801C9.22338 14.7805 9.14276 14.5894 8.99981 14.4501L3.29975 8.75H27.25C27.6642 8.75 28 8.41421 28 8C28 7.58579 27.6642 7.25 27.25 7.25H3.29756L9.00981 1.52006C9.15276 1.38077 9.23338 1.18965 9.23338 0.990063C9.23338 0.790475 9.15276 0.59935 9.00981 0.460063C8.71699 0.167609 8.24263 0.167609 7.94981 0.460063L0.949809 7.46006C0.657355 7.75288 0.657355 8.22724 0.949809 8.52006L7.94981 15.5201Z"
                fill="#252525" />
        </svg>
    </a>
    <h2>Cambiar contraseña</h2>

    <div class="perfil-form">
        <form id="password_form">
            <span>La contraseña debe tener al menos seis caracteres
                e incluir una combinacion de numero y letra.</span>
            <div class="form-group">
                <input class="form-control" type="password" id="password_anterior" autocomplete="current-password"
                    required placeholder="Contraseña anterior">
            </div>
            <div class="form-group">
                <input class="form-control" type="password" id="password_nueva" autocomplete="new-password" required
                    placeholder="Contraseña nueva">
            </div>
            <div class="form-group">
                <input class="form-control" type="password" id="password_nueva_confirm" autocomplete="new-password"
                    required placeholder="Repetir Contraseña nueva">
            </div>
            <button type="submit" class="btn btn-primary">Cambiar contraseña</button>

        </form>
    </div>

    <div class="large-line"></div>

    <script type="module" th:inline="javascript">
        import { enviarFetch } from '../../js/fetch.js';

        const btnVolverPerfil3 = document.querySelector('#btn_perfil2');
        btnVolverPerfil3.addEventListener('click', function () {
            const mostrarPerfilVista3 = document.querySelector('.perfil');
            mostrarPerfilVista3.style.display = 'block';
            const ocultarEdicion3 = document.querySelector('.editar-password');
            ocultarEdicion3.style.display = 'none';
            const mostrarMenuFlot3 = document.querySelector('.menu');
            mostrarMenuFlot3.style.display = 'flex';
        });

        const passwordForm = document.querySelector('#password_form');
        passwordForm.addEventListener('submit', function (event) {
            event.preventDefault();

            let passwordActual = document.getElementById('password_anterior').value;
            let password1 = document.getElementById('password_nueva').value;
            let password2 = document.getElementById('password_nueva_confirm').value;
            let emailUsuario = /*[[${email}]]*/ '';

            let passwordData = {
                email: emailUsuario
            };

            if (passwordActual != null) {
                passwordData.passwordActual = passwordActual;
            }
            if (password1 != null) {
                passwordData.password1 = password1;
            }
            if (password2 != null) {
                passwordData.password2 = password2;
            }
            const token = localStorage.getItem('token');
            const rol = localStorage.getItem('rol');
            let url = '';

            if (rol == 'CLIENTE') {
                url = '/cliente/actualizar/password';
            } else if (rol == 'ADMIN') {
                url = '/admin/actualizar/password';
            } else if (rol == 'JEFE_COCINA') {
                url = '/jefe_cocina/actualizar/password';
            } else if (rol == 'MESERO') {
                url = '/mesero/actualizar/password';
            }

            enviarFetch(url, 'POST', passwordData,
                function (data) {
                    console.log(data);
                },
                function (error) {
                    console.log(error);
                },
                token
            );
        });
    </script>
</div>